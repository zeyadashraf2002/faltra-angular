<!-- ๐ companies.component.html - Professional Dashboard -->
<div class="dashboard-container" dir="rtl">
  
  <!-- Top Navigation Bar -->
  <nav class="dashboard-nav">
    <div class="nav-content">
      <div class="nav-brand">
        <i class="bi bi-buildings"></i>
        <div>
          <h5>ูุธุงู ููุชุฑู</h5>
          <small>ุฅุฏุงุฑุฉ ุงูุดุฑูุงุช</small>
        </div>
      </div>
      
      <div class="nav-user">
        <div class="user-info">
          <strong>{{ authService.currentUser?.fullName }}</strong>
          <span class="user-role">
            {{ authService.currentUser?.role === 'developer' ? 'ูุทูุฑ' : 'ูุฏูุฑ' }}
          </span>
        </div>
        <button class="btn-logout" (click)="logout()">
          <i class="bi bi-box-arrow-left"></i>
          ุฎุฑูุฌ
        </button>
      </div>
    </div>
  </nav>

  <!-- Main Content -->
  <div class="dashboard-main">
    <div class="container-fluid">
      
      <!-- Page Header -->
      <div class="page-header">
        <div>
          <h1>ุฅุฏุงุฑุฉ ุงูุดุฑูุงุช</h1>
          <p>ุนุฑุถ ููุชุงุจุนุฉ ุจูุงูุงุช ุงูุดุฑูุงุช ูุงูุงุดุชุฑุงูุงุช</p>
        </div>
        <div class="stats-badge">
          <i class="bi bi-buildings"></i>
          <span>{{ filteredCompanies.length }} ุดุฑูุฉ</span>
        </div>
      </div>

      <!-- Search & Filters -->
      <div class="toolbar">
        <div class="search-box">
          <i class="bi bi-search"></i>
          <input 
            type="text" 
            placeholder="ุงุจุญุซ ุนู ุดุฑูุฉ..."
            [(ngModel)]="searchQuery"
            (input)="onSearchChange()">
        </div>
      </div>

      <!-- Loading State -->
      @if (isLoading) {
        <div class="loading-state">
          <div class="spinner"></div>
          <p>ุฌุงุฑู ุชุญููู ุงูุดุฑูุงุช...</p>
        </div>
      }

      <!-- Empty State -->
      @if (!isLoading && filteredCompanies.length === 0) {
        <div class="empty-state">
          <i class="bi bi-inbox"></i>
          <h3>ูุง ุชูุฌุฏ ุดุฑูุงุช</h3>
          <p>ูู ูุชู ุงูุนุซูุฑ ุนูู ุฃู ุดุฑูุงุช ูุทุงุจูุฉ</p>
        </div>
      }

      <!-- Companies Grid -->
      @if (!isLoading && filteredCompanies.length > 0) {
        <div class="companies-grid">
          @for (company of paginatedCompanies; track company.id) {
            <div class="company-card">
              
              <!-- Card Header -->
              <div class="card-header">
                <div class="company-identity">
                  @if (company.logo) {
                    <img [src]="company.logo" [alt]="company.name" class="company-logo">
                  } @else {
                    <div class="company-logo-placeholder">
                      <i class="bi bi-building"></i>
                    </div>
                  }
                  <div>
                    <h3>{{ company.name }}</h3>
                    <span class="company-id">#{{ company.id }}</span>
                  </div>
                </div>
                
                <div class="status-badge"
                     [class.active]="!isExpired(company.subscriptionExpiryDate)"
                     [class.expired]="isExpired(company.subscriptionExpiryDate)">
                  {{ isExpired(company.subscriptionExpiryDate) ? 'ููุชูู' : 'ุณุงุฑู' }}
                </div>
              </div>

              <!-- Card Body -->
              <div class="card-body">
                <div class="info-grid">
                  
                  <div class="info-row">
                    <i class="bi bi-geo-alt"></i>
                    <div>
                      <label>ุงูุนููุงู</label>
                      <span>{{ company.address || 'ุบูุฑ ูุญุฏุฏ' }}</span>
                    </div>
                  </div>

                  <div class="info-row">
                    <i class="bi bi-envelope"></i>
                    <div>
                      <label>ุงูุจุฑูุฏ</label>
                      <span>{{ company.email || 'ุบูุฑ ูุญุฏุฏ' }}</span>
                    </div>
                  </div>

                  <div class="info-row">
                    <i class="bi bi-telephone"></i>
                    <div>
                      <label>ุงููุงุชู</label>
                      <span>{{ company.phone || 'ุบูุฑ ูุญุฏุฏ' }}</span>
                    </div>
                  </div>

                  <div class="info-row">
                    <i class="bi bi-calendar-check"></i>
                    <div>
                      <label>ุชุงุฑูุฎ ุงูุฅูุดุงุก</label>
                      <span>{{ company.createdAt | date: 'dd/MM/yyyy' }}</span>
                    </div>
                  </div>

                  <div class="info-row highlight">
                    <i class="bi bi-calendar-x" 
                       [class.text-danger]="isExpired(company.subscriptionExpiryDate)"
                       [class.text-success]="!isExpired(company.subscriptionExpiryDate)">
                    </i>
                    <div>
                      <label>ุงูุชูุงุก ุงูุงุดุชุฑุงู</label>
                      <span [class.text-danger]="isExpired(company.subscriptionExpiryDate)"
                            [class.text-success]="!isExpired(company.subscriptionExpiryDate)">
                        {{ company.subscriptionExpiryDate | date: 'dd/MM/yyyy' }}
                      </span>
                    </div>
                  </div>

                </div>
              </div>

              <!-- Card Actions -->
              @if (authService.isDeveloper) {
                <div class="card-actions">
                  <button class="btn-edit" (click)="openExpiryModal(company)">
                    <i class="bi bi-calendar-plus"></i>
                    ุชุนุฏูู ุงูุงุดุชุฑุงู
                  </button>
                </div>
              }

            </div>
          }
        </div>
      }

      <!-- Pagination -->
      @if (totalPages > 1) {
        <nav class="pagination-nav">
          <button 
            class="btn-page"
            [disabled]="currentPage === 1"
            (click)="goToPage(currentPage - 1)">
            <i class="bi bi-chevron-right"></i>
            ุงูุณุงุจู
          </button>
          
          <div class="page-numbers">
            @for (page of pages; track page) {
              <button 
                class="btn-page-number"
                [class.active]="page === currentPage"
                (click)="goToPage(page)">
                {{ page }}
              </button>
            }
          </div>
          
          <button 
            class="btn-page"
            [disabled]="currentPage === totalPages"
            (click)="goToPage(currentPage + 1)">
            ุงูุชุงูู
            <i class="bi bi-chevron-left"></i>
          </button>
        </nav>
      }

    </div>
  </div>
</div>

<!-- Modal -->

