<!-- ๐ src/app/components/how-it-works/how-it-works.html - WITH AUTO-PLAY VIDEO -->
<section id="how-it-works" class="how-it-works-modern" dir="rtl">
  <div class="container">
    
    <!-- Section Header -->
    <div class="section-header" data-aos="fade-up">
      <div class="section-badge">
        <i class="bi bi-lightbulb"></i>
        <span>ููู ูุนูู</span>
      </div>
      <h2 class="section-title">
        ุงุจุฏุฃ ูู
        <span class="gradient-text">3 ุฎุทูุงุช ุจุณูุทุฉ</span>
      </h2>
      <p class="section-subtitle">
        ูู ุงูุชุณุฌูู ุฅูู ุฅุฏุงุฑุฉ ุดุฑูุชู ุจุงููุงูู ูู ุฏูุงุฆู ูุนุฏูุฏุฉ
      </p>
    </div>

    <!-- Steps Timeline -->
    <div class="steps-timeline">
      
      @for (step of steps; track step.id) {
        <div 
          class="step-item"
          [attr.data-aos]="'fade-up'"
          [attr.data-aos-delay]="$index * 150">
          
          <!-- Step Number Circle -->
          <div class="step-circle">
            <div class="circle-outer">
              <div class="circle-inner">
                <span class="step-number">{{ step.number }}</span>
              </div>
            </div>
            
            <!-- Connection Line -->
            @if ($index < steps.length - 1) {
              <div class="connection-line"></div>
            }
          </div>

          <!-- Step Content -->
          <div class="step-content">
            
            <!-- Icon Box -->
            <div class="step-icon">
              <i [class]="step.icon"></i>
            </div>

            <!-- Text Content -->
            <div class="step-text">
              <h3>{{ step.title }}</h3>
              <p>{{ step.description }}</p>
              
              <!-- Features List -->
              <ul class="step-features">
                @for (feature of step.features; track feature) {
                  <li>
                    <i class="bi bi-check-circle-fill"></i>
                    <span>{{ feature }}</span>
                  </li>
                }
              </ul>

              <!-- Action Button -->
              @if (step.action) {
                <button class="btn-step-action" (click)="handleAction(step.action)">
                  {{ step.actionLabel }}
                  <i class="bi bi-arrow-left"></i>
                </button>
              }
            </div>

          </div>

        </div>
      }

    </div>

    <!-- Quick Stats -->
    <div class="quick-stats" data-aos="zoom-in">
      <div class="stat-box" data-aos="flip-up" data-aos-delay="100">
        <i class="bi bi-clock"></i>
        <div class="stat-content">
          <h4>5 ุฏูุงุฆู</h4>
          <p>ููุช ุงูุฅุนุฏุงุฏ</p>
        </div>
      </div>

      <div class="stat-box" data-aos="flip-up" data-aos-delay="200">
        <i class="bi bi-patch-check"></i>
        <div class="stat-content">
          <h4>ุจุฏูู ุชุนููุฏ</h4>
          <p>ูุงุฌูุฉ ุณููุฉ</p>
        </div>
      </div>

      <div class="stat-box" data-aos="flip-up" data-aos-delay="300">
        <i class="bi bi-rocket-takeoff"></i>
        <div class="stat-content">
          <h4>ุงุจุฏุฃ ููุฑุงู</h4>
          <p>ูุง ุญุงุฌุฉ ูุชุฏุฑูุจ</p>
        </div>
      </div>
    </div>

    <!-- โ Video Tutorial Section with Auto-Play -->
    <div class="video-tutorial" data-aos="fade-up">
      <div class="video-wrapper">
        
        <!-- Video Player -->
        @if (showVideo) {
          <div class="video-player-container">
            
            <!-- YouTube Embed -->
            @if (useYouTube) {
              <iframe 
                class="video-iframe"
                [src]="videoUrl | safe:'resourceUrl'"
                frameborder="0"
                allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                allowfullscreen>
              </iframe>
            }
            
            <!-- Local Video -->
            @if (!useYouTube) {
              <video 
                #videoPlayer
                class="video-element"
                [src]="localVideoUrl"
                controls
                muted
                loop
                playsinline>
                ุงููุชุตูุญ ูุง ูุฏุนู ุชุดุบูู ุงูููุฏูู
              </video>
            }
            
            <!-- Close Button -->
            <button class="btn-close-video" (click)="pauseVideo()">
              <i class="bi bi-x-lg"></i>
            </button>
          </div>
        }

        <!-- Video Placeholder (Before Play) -->
        @if (!showVideo) {
          <div class="video-content">
            <div class="video-icon">
              <i class="bi bi-play-circle"></i>
            </div>
            <h3>ุดุงูุฏ ููุฏูู ูุชูุถูุญ AI </h3>
            <p>ุชุนุฑู ุนูู ููููุฉ ุงุณุชุฎุฏุงู AI ุฏุงุฎู ุงููุธุงู </p>
            <button class="btn-watch-video" (click)="onManualPlay()">
              <i class="bi bi-play-fill"></i>
              <span>ูุดุงูุฏุฉ ุงูููุฏูู</span>
            </button>
          </div>
        }

      </div>
    </div>

    <!-- CTA Section -->
    <div class="cta-section" data-aos="zoom-in">
      <div class="cta-content">
        <h3>ุฌุงูุฒ ููุจุฏุกุ</h3>
        <p>ุงุจุฏุฃ ุชุฌุฑุจุชู ุงููุฌุงููุฉ ููุฏุฉ 14 ููู ุจุฏูู ุงูุญุงุฌุฉ ูุจุทุงูุฉ ุงุฆุชูุงู</p>
        <div class="cta-buttons">
          <button class="btn-cta-primary" (click)="startTrial()">
            <i class="bi bi-rocket-takeoff"></i>
            <span>ุงุจุฏุฃ ุชุฌุฑุจุชู ุงููุฌุงููุฉ</span>
          </button>
          <button class="btn-cta-secondary" (click)="scheduleDemo()">
            <i class="bi bi-calendar-check"></i>
            <span>ุงุญุฌุฒ ุนุฑุถ ุชูุถูุญู</span>
          </button>
        </div>
      </div>
    </div>

  </div>

  <!-- Background Elements -->
  <div class="bg-decoration decoration-1"></div>
  <div class="bg-decoration decoration-2"></div>

  <!-- Animated Dots -->
  <div class="animated-dots">
    @for (dot of [1,2,3,4,5,6,7,8]; track dot) {
      <div class="dot" [style.animation-delay.s]="dot * 0.3"></div>
    }
  </div>

</section>